<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Learn to create stunning outdoor lighting in Unreal Engine 5. Set up the Directional Light as sun, configure Sky Atmosphere, add fog, and build dynamic time-of-day systems.">
    <meta name="author" content="Practical Ace">
    <title>The Directional Light and Sky - Introduction to Unreal Engine 5</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="icon" type="image/png" href="/favicon.png">
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#f0f0f0',
                primaryTextColor: '#333',
                primaryBorderColor: '#667eea'
            }
        });
    </script>
</head>
<body>
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-to-main">Skip to main content</a>

    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <a href="index.html" class="nav-logo">Introduction to Unreal Engine 5</a>
            <button id="mobile-menu-toggle" class="mobile-menu-toggle" aria-expanded="false" aria-controls="nav-links">
                ‚ò∞
            </button>
            <div class="nav-links" id="nav-links" aria-hidden="false">
                <a href="index.html">Home</a>
                <a href="index.html#modules">All Modules</a>
                <button id="theme-toggle" aria-label="Toggle theme">üåô</button>
            </div>
        </div>
    </nav>

    <!-- Breadcrumb -->
    <nav class="breadcrumb" aria-label="Breadcrumb">
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="index.html#modules">Module 4: Lighting Your World</a></li>
            <li aria-current="page">Lesson 4.2: The Directional Light and Sky</li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main id="main-content">
        <div class="container">
            <!-- Lesson Header -->
            <header>
                <h1>‚òÄÔ∏è The Directional Light and Sky</h1>
                <p class="lead">Nothing defines the mood of an outdoor environment more than the sky. The warm golden light of sunrise, the harsh shadows of midday, the soft purple hues of dusk‚Äîall come from how sunlight interacts with our atmosphere. In this lesson, you'll learn to recreate these natural phenomena in Unreal Engine, building a complete outdoor sky system from the ground up. By the end, you'll have the skills to light any exterior environment convincingly.</p>
                
                <!-- Learning objectives -->
                <div class="card">
                    <h2>üéØ Learning Objectives</h2>
                    <p>By the end of this lesson, you will be able to:</p>
                    <ul>
                        <li>Configure a Directional Light to simulate the sun with proper settings</li>
                        <li>Set up the Sky Atmosphere component for physically accurate skies</li>
                        <li>Use Exponential Height Fog to add depth and atmosphere</li>
                        <li>Configure a SkyLight for proper ambient illumination</li>
                        <li>Create dynamic time-of-day systems that transition smoothly</li>
                        <li>Build a complete outdoor lighting setup from scratch</li>
                    </ul>
                    <p><strong>Estimated Time:</strong> 50-60 minutes</p>
                    <p><strong>Prerequisites:</strong> Lesson 4.1 - Lighting Fundamentals</p>
                </div>
            </header>

            <!-- Sticky Table of Contents -->
            <details class="card" open style="position: sticky; top: 80px; z-index: 100; background: var(--card-bg, white); box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem;">
                <summary style="cursor: pointer; font-weight: bold; padding: 0.5rem 1rem; user-select: none;">
                    <h2 style="display: inline; margin: 0;">üìë In This Lesson</h2>
                </summary>
                <nav aria-label="Table of Contents" style="padding: 0 1rem 1rem 1rem;">
                    <ol>
                        <li><a href="#directional-light" class="toc-link">Creating a Sun with Directional Light</a></li>
                        <li><a href="#sky-atmosphere" class="toc-link">Sky Atmosphere Component</a></li>
                        <li><a href="#height-fog" class="toc-link">Exponential Height Fog</a></li>
                        <li><a href="#skylight" class="toc-link">SkyLight for Ambient Illumination</a></li>
                        <li><a href="#time-of-day" class="toc-link">Time-of-Day Setups</a></li>
                        <li><a href="#hands-on" class="toc-link">Hands-On: Outdoor Daytime Sky</a></li>
                        <li><a href="#summary" class="toc-link">Summary</a></li>
                    </ol>
                </nav>
            </details>

            <!-- Section 1: Creating a Sun with Directional Light -->
            <section id="directional-light" class="lesson-section">
                <h2>Creating a Sun with Directional Light</h2>

                <p>The Directional Light is the foundation of outdoor lighting. It simulates light from an infinitely distant source‚Äîperfect for representing the sun or moon. Because the source is so far away, all light rays are parallel, which is exactly how sunlight behaves on Earth.</p>

                <h3>Placing a Directional Light</h3>

                <p>There are several ways to add a Directional Light to your level:</p>

                <p><strong>Method 1 - Quick Add Menu:</strong> In the viewport, right-click ‚Üí Lights ‚Üí Directional Light. Click to place it.</p>

                <p><strong>Method 2 - Place Actors Panel:</strong> Go to Window ‚Üí Place Actors (or press Ctrl+Shift+1). Under Lights, drag Directional Light into the viewport.</p>

                <p><strong>Method 3 - Content Browser:</strong> Search for "Directional Light" in Place Actors and drag it in.</p>

                <p>Once placed, you'll see the light represented by an arrow indicating the direction light travels. The light's position in the world doesn't matter‚Äîonly its rotation determines where shadows fall.</p>

                <div class="card" style="background: #e8f5e9; border-left: 4px solid #4CAF50;">
                    <h4>‚úÖ Pro Tip: One Sun Rule</h4>
                    <p>In most cases, you should have only <strong>one Directional Light</strong> in your outdoor scene representing the sun. Multiple directional lights create confusing double shadows and are rarely physically accurate. The exception is stylized or fantasy environments where multiple suns might be intentional.</p>
                </div>

                <h3>Essential Directional Light Settings</h3>

                <p>Select your Directional Light and examine the Details panel. Here are the key settings you'll use:</p>

                <h4>Light Section</h4>

                <p><strong>Intensity:</strong> Controls the brightness of the light. For outdoor sun, values between 3-10 lux (with proper exposure) work well. Default is often fine as a starting point.</p>

                <p><strong>Light Color:</strong> The color of the sunlight. Pure white (1,1,1) for midday sun. Warm orange (1.0, 0.95, 0.85) for sunrise/sunset. Cool blue tint for overcast days.</p>

                <p><strong>Temperature:</strong> Alternative way to set color using Kelvin temperature scale. Enable "Use Temperature" checkbox to use this. 6500K is neutral daylight; lower values (3000K) are warmer, higher values (10000K) are cooler/bluer.</p>

                <!-- SVG: Color Temperature Scale -->
                <svg width="100%" height="120" viewBox="0 0 800 120" style="max-width: 800px; margin: 2rem auto; display: block; border: 2px solid #667eea; border-radius: 8px; background: #1e1e1e;">
                    <text x="400" y="25" text-anchor="middle" fill="#fff" font-size="14" font-weight="bold">Color Temperature Scale (Kelvin)</text>
                    
                    <!-- Temperature gradient bar -->
                    <defs>
                        <linearGradient id="tempGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#ff6b35"/>
                            <stop offset="20%" style="stop-color:#ff9f43"/>
                            <stop offset="40%" style="stop-color:#feca57"/>
                            <stop offset="50%" style="stop-color:#fff"/>
                            <stop offset="70%" style="stop-color:#a8d8ff"/>
                            <stop offset="100%" style="stop-color:#6bc5ff"/>
                        </linearGradient>
                    </defs>
                    
                    <rect x="50" y="45" width="700" height="30" fill="url(#tempGradient)" rx="5"/>
                    
                    <!-- Temperature markers -->
                    <line x1="120" y1="75" x2="120" y2="85" stroke="#aaa"/>
                    <text x="120" y="100" text-anchor="middle" fill="#aaa" font-size="9">2000K</text>
                    <text x="120" y="112" text-anchor="middle" fill="#888" font-size="8">Candle</text>
                    
                    <line x1="260" y1="75" x2="260" y2="85" stroke="#aaa"/>
                    <text x="260" y="100" text-anchor="middle" fill="#aaa" font-size="9">3500K</text>
                    <text x="260" y="112" text-anchor="middle" fill="#888" font-size="8">Sunrise</text>
                    
                    <line x1="400" y1="75" x2="400" y2="85" stroke="#fff" stroke-width="2"/>
                    <text x="400" y="100" text-anchor="middle" fill="#fff" font-size="9" font-weight="bold">5500-6500K</text>
                    <text x="400" y="112" text-anchor="middle" fill="#4CAF50" font-size="8">Daylight</text>
                    
                    <line x1="540" y1="75" x2="540" y2="85" stroke="#aaa"/>
                    <text x="540" y="100" text-anchor="middle" fill="#aaa" font-size="9">8000K</text>
                    <text x="540" y="112" text-anchor="middle" fill="#888" font-size="8">Overcast</text>
                    
                    <line x1="680" y1="75" x2="680" y2="85" stroke="#aaa"/>
                    <text x="680" y="100" text-anchor="middle" fill="#aaa" font-size="9">10000K+</text>
                    <text x="680" y="112" text-anchor="middle" fill="#888" font-size="8">Blue Sky</text>
                </svg>
                <p class="caption"><em>Figure: Color temperature ranges from warm (low K) to cool (high K). Daylight is around 5500-6500K.</em></p>

                <p><strong>Source Angle:</strong> Controls the angular size of the sun disk, which affects shadow softness. Larger values create softer shadows. Real sun is about 0.5¬∞. Use 1-5¬∞ for softer, more forgiving shadows.</p>

                <p><strong>Source Soft Angle:</strong> Additional softening beyond Source Angle. Adds a gradual falloff to shadow edges.</p>

                <h4>Atmosphere and Cloud Section</h4>

                <p><strong>Atmosphere Sun Light:</strong> Enable this to make this light interact with the Sky Atmosphere component. Essential for realistic sky colors at sunrise/sunset.</p>

                <p><strong>Cast Shadows on Clouds:</strong> When using Volumetric Clouds, this allows the sun to cast shadows on cloud layers.</p>

                <p><strong>Cast Cloud Shadows:</strong> Allows clouds to cast shadows on the ground (requires Volumetric Clouds).</p>

                <h4>Cascaded Shadow Maps</h4>

                <p>Directional lights use <strong>Cascaded Shadow Maps (CSM)</strong>‚Äîa technique that renders multiple shadow maps at different resolutions for different distances from the camera. This provides sharp shadows nearby and acceptable shadows at distance without enormous texture memory.</p>

                <p><strong>Dynamic Shadow Distance MovableLight:</strong> How far shadows render for movable objects. Higher values mean shadows visible at greater distances but lower quality per-distance.</p>

                <p><strong>Num Dynamic Shadow Cascades:</strong> Number of shadow map cascades (usually 3-5). More cascades = better quality distribution but higher cost.</p>

                <p><strong>Cascade Distribution Exponent:</strong> Controls how cascade distances are distributed. Higher values concentrate detail near camera. Value of 3 is common.</p>

                <!-- SVG: Cascaded Shadow Maps -->
                <svg width="100%" height="200" viewBox="0 0 800 200" style="max-width: 800px; margin: 2rem auto; display: block; border: 2px solid #667eea; border-radius: 8px; background: #f9f9f9;">
                    <text x="400" y="25" text-anchor="middle" fill="#333" font-size="14" font-weight="bold">Cascaded Shadow Maps Visualization</text>
                    
                    <!-- Camera -->
                    <polygon points="50,100 70,80 70,120" fill="#667eea"/>
                    <text x="60" y="135" text-anchor="middle" fill="#333" font-size="9">Camera</text>
                    
                    <!-- View frustum -->
                    <polygon points="70,90 750,50 750,150 70,110" fill="none" stroke="#888" stroke-dasharray="3,3"/>
                    
                    <!-- Cascade 1 -->
                    <rect x="80" y="70" width="150" height="60" fill="#4CAF50" opacity="0.4" stroke="#4CAF50" stroke-width="2"/>
                    <text x="155" y="105" text-anchor="middle" fill="#2e7d32" font-size="10" font-weight="bold">Cascade 1</text>
                    <text x="155" y="145" text-anchor="middle" fill="#333" font-size="8">Highest resolution</text>
                    <text x="155" y="157" text-anchor="middle" fill="#333" font-size="8">0-50m</text>
                    
                    <!-- Cascade 2 -->
                    <rect x="230" y="65" width="180" height="70" fill="#FF9800" opacity="0.4" stroke="#FF9800" stroke-width="2"/>
                    <text x="320" y="105" text-anchor="middle" fill="#e65100" font-size="10" font-weight="bold">Cascade 2</text>
                    <text x="320" y="150" text-anchor="middle" fill="#333" font-size="8">Medium resolution</text>
                    <text x="320" y="162" text-anchor="middle" fill="#333" font-size="8">50-200m</text>
                    
                    <!-- Cascade 3 -->
                    <rect x="410" y="58" width="200" height="84" fill="#2196F3" opacity="0.4" stroke="#2196F3" stroke-width="2"/>
                    <text x="510" y="105" text-anchor="middle" fill="#1565c0" font-size="10" font-weight="bold">Cascade 3</text>
                    <text x="510" y="155" text-anchor="middle" fill="#333" font-size="8">Lower resolution</text>
                    <text x="510" y="167" text-anchor="middle" fill="#333" font-size="8">200-800m</text>
                    
                    <!-- Cascade 4 -->
                    <rect x="610" y="52" width="130" height="96" fill="#9C27B0" opacity="0.4" stroke="#9C27B0" stroke-width="2"/>
                    <text x="675" y="105" text-anchor="middle" fill="#7b1fa2" font-size="10" font-weight="bold">Cascade 4</text>
                    <text x="675" y="160" text-anchor="middle" fill="#333" font-size="8">Lowest res</text>
                    <text x="675" y="172" text-anchor="middle" fill="#333" font-size="8">800m+</text>
                </svg>
                <p class="caption"><em>Figure: Each cascade covers a larger area with progressively lower resolution shadow maps.</em></p>

                <h3>Setting the Sun Position</h3>

                <p>The Directional Light's <strong>Rotation</strong> determines the sun's position in the sky. The most important rotation axis is <strong>Pitch</strong> (up/down):</p>

                <p><strong>Pitch -90¬∞:</strong> Sun directly overhead (noon)</p>
                <p><strong>Pitch -45¬∞:</strong> Sun at 45¬∞ angle (morning/afternoon)</p>
                <p><strong>Pitch 0¬∞ to -10¬∞:</strong> Sun near horizon (sunrise/sunset)</p>
                <p><strong>Pitch above 0¬∞:</strong> Sun below horizon (night)</p>

                <p>The <strong>Yaw</strong> rotation determines the compass direction of the sun‚Äîwhich direction shadows are cast.</p>

                <div class="card" style="background: #e3f2fd; border-left: 4px solid #2196F3;">
                    <h4>üí° Quick Sun Positioning</h4>
                    <p>With the Directional Light selected, hold <strong>Ctrl+L</strong> and drag in the viewport to interactively rotate the sun position. This gives immediate visual feedback of how the lighting changes‚Äîextremely useful for finding the perfect sun angle.</p>
                </div>

                <h3>Mobility for Directional Lights</h3>

                <p>Your choice of mobility affects what's possible:</p>

                <p><strong>Static:</strong> Sun position fixed. All shadows baked. Zero runtime cost but no time-of-day changes possible.</p>

                <p><strong>Stationary:</strong> Sun position fixed, but color/intensity can change at runtime. Indirect lighting baked, direct lighting dynamic. Good for fixed sun with weather changes.</p>

                <p><strong>Movable:</strong> Full flexibility‚Äîsun can move for time-of-day systems. Required for dynamic day/night cycles. With Lumen, maintains full GI. Without Lumen, loses baked indirect lighting.</p>

                <!-- Mermaid: Directional Light Setup Flow -->
                <pre class="mermaid">
flowchart LR
    A["Add Directional<br/>Light"] --> B["Set Rotation<br/>(Sun Position)"]
    B --> C["Adjust Intensity<br/>& Color"]
    C --> D["Configure<br/>Shadows"]
    D --> E{"Time of Day<br/>Needed?"}
    E -->|Yes| F["Set Movable<br/>+ Use Lumen"]
    E -->|No| G["Set Stationary<br/>+ Build Lighting"]
    F --> H["Link to Sky<br/>Atmosphere"]
    G --> H
    
    style A fill:#667eea,color:#fff
    style H fill:#4CAF50,color:#fff
                </pre>
                <p class="caption"><em>Figure: Basic workflow for setting up a Directional Light as the sun.</em></p>
            </section>

            <!-- Section 2: Sky Atmosphere Component -->
            <section id="sky-atmosphere" class="lesson-section">
                <h2>Sky Atmosphere Component</h2>

                <p>The <strong>Sky Atmosphere</strong> component simulates Earth's atmosphere‚Äîhow light scatters through air to create blue skies, orange sunsets, and the gradient from horizon to zenith. It works in conjunction with your Directional Light to create physically accurate sky rendering.</p>

                <h3>How Atmospheric Scattering Works</h3>

                <p>In the real world, the sky isn't simply "blue." Its color comes from <strong>Rayleigh scattering</strong>‚Äîsunlight bouncing off tiny air molecules. Blue light scatters more than red, which is why:</p>

                <ul>
                    <li>The sky appears blue during the day (blue light scattered toward us)</li>
                    <li>Sunsets are orange/red (light travels through more atmosphere, blue scattered away)</li>
                    <li>The horizon is often lighter/hazier than the zenith (more atmosphere to look through)</li>
                </ul>

                <p>Unreal's Sky Atmosphere calculates all of this in real-time, responding to your Directional Light's position.</p>

                <!-- SVG: Atmospheric Scattering -->
                <svg width="100%" height="240" viewBox="0 0 800 240" style="max-width: 800px; margin: 2rem auto; display: block; border: 2px solid #667eea; border-radius: 8px; background: linear-gradient(to bottom, #0a1628 0%, #1a3a5c 30%, #4a90c2 70%, #87ceeb 100%);">
                    <text x="400" y="25" text-anchor="middle" fill="#fff" font-size="14" font-weight="bold">Rayleigh Scattering in the Atmosphere</text>
                    
                    <!-- Earth curve -->
                    <ellipse cx="400" cy="450" rx="500" ry="250" fill="#2d5016" stroke="#4a7c23" stroke-width="2"/>
                    
                    <!-- Atmosphere layers -->
                    <ellipse cx="400" cy="450" rx="520" ry="270" fill="none" stroke="rgba(255,255,255,0.2)" stroke-dasharray="5,5"/>
                    
                    <!-- Sun at horizon -->
                    <circle cx="100" cy="200" r="25" fill="#f39c12"/>
                    <circle cx="100" cy="200" r="30" fill="none" stroke="#f1c40f" stroke-width="2" opacity="0.5"/>
                    
                    <!-- Light rays -->
                    <line x1="125" y1="195" x2="300" y2="180" stroke="#f1c40f" stroke-width="2"/>
                    <line x1="125" y1="200" x2="400" y2="185" stroke="#f1c40f" stroke-width="2"/>
                    <line x1="125" y1="205" x2="500" y2="195" stroke="#f1c40f" stroke-width="2"/>
                    
                    <!-- Scattered blue light -->
                    <path d="M 300 180 Q 320 120 380 100" stroke="#87ceeb" stroke-width="2" fill="none" stroke-dasharray="3,3"/>
                    <path d="M 350 182 Q 380 130 430 90" stroke="#87ceeb" stroke-width="2" fill="none" stroke-dasharray="3,3"/>
                    <path d="M 400 185 Q 420 140 480 110" stroke="#87ceeb" stroke-width="2" fill="none" stroke-dasharray="3,3"/>
                    
                    <!-- Labels -->
                    <rect x="500" y="45" width="280" height="100" rx="5" fill="rgba(0,0,0,0.5)"/>
                    <text x="640" y="70" text-anchor="middle" fill="#87ceeb" font-size="11" font-weight="bold">Blue Light</text>
                    <text x="640" y="88" text-anchor="middle" fill="#aaa" font-size="9">Scatters in all directions</text>
                    <text x="640" y="103" text-anchor="middle" fill="#aaa" font-size="9">(shorter wavelength)</text>
                    
                    <text x="640" y="125" text-anchor="middle" fill="#f39c12" font-size="11" font-weight="bold">Orange/Red Light</text>
                    <text x="640" y="143" text-anchor="middle" fill="#aaa" font-size="9">Passes through atmosphere</text>
                    
                    <!-- Observer -->
                    <circle cx="450" cy="195" r="8" fill="#fff"/>
                    <text x="450" y="175" text-anchor="middle" fill="#fff" font-size="9">Observer</text>
                    
                    <!-- Arrow showing scattered blue reaching observer -->
                    <path d="M 420 110 L 445 185" stroke="#87ceeb" stroke-width="2" marker-end="url(#blueArrow)"/>
                    <defs>
                        <marker id="blueArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#87ceeb"/>
                        </marker>
                    </defs>
                </svg>
                <p class="caption"><em>Figure: Blue light scatters toward the observer; red/orange light passes through at low sun angles.</em></p>

                <h3>Adding Sky Atmosphere</h3>

                <p><strong>Method 1:</strong> Place Actors panel ‚Üí Visual Effects ‚Üí Sky Atmosphere</p>

                <p><strong>Method 2:</strong> Right-click in viewport ‚Üí Place Actor ‚Üí Sky Atmosphere</p>

                <p>Once placed, the Sky Atmosphere automatically finds your Directional Light (if it has "Atmosphere Sun Light" enabled) and generates the sky based on the light's direction.</p>

                <div class="card" style="background: #1a1a2e; border-left: 4px solid #667eea;">
                    <h4>üìñ Definition</h4>
                    <p style="color: white;"><strong>Sky Atmosphere:</strong> A component that simulates single-scattering of light through a planetary atmosphere, producing realistic sky colors, aerial perspective, and sun disk rendering based on physical models of atmospheric optics.</p>
                </div>

                <h3>Key Sky Atmosphere Settings</h3>

                <h4>Atmosphere Section</h4>

                <p><strong>Ground Radius:</strong> Radius of the planet (default matches Earth at 6360 km). Changing this affects the curvature visible at horizons.</p>

                <p><strong>Atmosphere Height:</strong> Thickness of the atmosphere layer. Default is 60 km. Thicker atmospheres create more scattering and hazier horizons.</p>

                <h4>Rayleigh Scattering</h4>

                <p><strong>Rayleigh Scattering Scale:</strong> Overall intensity of small-particle scattering (air molecules). Higher values = more blue sky, more colorful sunsets.</p>

                <p><strong>Rayleigh Scattering:</strong> The RGB color of Rayleigh scattering. Default blue values create Earth-like skies. Adjust for alien planet atmospheres.</p>

                <p><strong>Rayleigh Exponential Distribution:</strong> How quickly Rayleigh scattering decreases with altitude. Higher values concentrate scattering at lower altitudes.</p>

                <h4>Mie Scattering</h4>

                <p><strong>Mie Scattering</strong> simulates larger particles like dust, pollution, and water droplets. This creates:</p>
                <ul>
                    <li>The bright halo around the sun</li>
                    <li>Hazy, milky-looking horizons</li>
                    <li>The "glow" in the direction of the sun</li>
                </ul>

                <p><strong>Mie Scattering Scale:</strong> Intensity of large-particle scattering. Increase for hazier, more polluted atmospheres.</p>

                <p><strong>Mie Anisotropy:</strong> Controls the directionality of Mie scattering. Higher values (0.8+) create a brighter, more concentrated sun glow. Lower values spread the glow wider.</p>

                <!-- SVG: Rayleigh vs Mie -->
                <svg width="100%" height="200" viewBox="0 0 800 200" style="max-width: 800px; margin: 2rem auto; display: block; border: 2px solid #667eea; border-radius: 8px; background: #1e1e1e;">
                    <text x="400" y="25" text-anchor="middle" fill="#fff" font-size="14" font-weight="bold">Rayleigh vs. Mie Scattering</text>
                    
                    <!-- Rayleigh -->
                    <g transform="translate(100, 60)">
                        <rect x="0" y="0" width="250" height="120" rx="8" fill="rgba(135,206,235,0.15)" stroke="#87ceeb" stroke-width="2"/>
                        <text x="125" y="25" text-anchor="middle" fill="#87ceeb" font-size="12" font-weight="bold">Rayleigh Scattering</text>
                        
                        <!-- Small particles -->
                        <circle cx="60" cy="70" r="3" fill="#87ceeb"/>
                        <circle cx="90" cy="60" r="2" fill="#87ceeb"/>
                        <circle cx="120" cy="75" r="3" fill="#87ceeb"/>
                        <circle cx="150" cy="65" r="2" fill="#87ceeb"/>
                        <circle cx="180" cy="72" r="3" fill="#87ceeb"/>
                        
                        <!-- Scattering pattern - all directions -->
                        <circle cx="120" cy="70" r="25" fill="none" stroke="#87ceeb" stroke-dasharray="3,3" opacity="0.5"/>
                        
                        <text x="125" y="105" text-anchor="middle" fill="#aaa" font-size="9">Air molecules ‚Ä¢ Blue sky color</text>
                        <text x="125" y="118" text-anchor="middle" fill="#aaa" font-size="9">Scatters equally in all directions</text>
                    </g>
                    
                    <!-- Mie -->
                    <g transform="translate(450, 60)">
                        <rect x="0" y="0" width="250" height="120" rx="8" fill="rgba(255,200,100,0.15)" stroke="#f39c12" stroke-width="2"/>
                        <text x="125" y="25" text-anchor="middle" fill="#f39c12" font-size="12" font-weight="bold">Mie Scattering</text>
                        
                        <!-- Larger particles -->
                        <circle cx="60" cy="70" r="6" fill="#f39c12" opacity="0.7"/>
                        <circle cx="100" cy="65" r="8" fill="#f39c12" opacity="0.7"/>
                        <circle cx="145" cy="72" r="7" fill="#f39c12" opacity="0.7"/>
                        <circle cx="190" cy="68" r="6" fill="#f39c12" opacity="0.7"/>
                        
                        <!-- Forward scattering pattern -->
                        <path d="M 145 72 Q 200 72 220 72" stroke="#f39c12" stroke-width="3" opacity="0.8"/>
                        <path d="M 145 72 Q 180 50 200 45" stroke="#f39c12" stroke-width="1" opacity="0.5"/>
                        <path d="M 145 72 Q 180 95 200 100" stroke="#f39c12" stroke-width="1" opacity="0.5"/>
                        
                        <text x="125" y="105" text-anchor="middle" fill="#aaa" font-size="9">Dust, water droplets ‚Ä¢ Sun halo</text>
                        <text x="125" y="118" text-anchor="middle" fill="#aaa" font-size="9">Scatters mainly forward</text>
                    </g>
                </svg>
                <p class="caption"><em>Figure: Rayleigh scatters uniformly (blue sky); Mie scatters forward (sun glow/haze).</em></p>

                <h4>Art Direction</h4>

                <p><strong>Sky Luminance Factor:</strong> Multiplier for overall sky brightness. Useful for artistic control without affecting atmosphere calculations.</p>

                <p><strong>Aerial Perspective View Distance Scale:</strong> Controls how quickly distant objects fade into atmospheric haze. Important for open-world scenes with long view distances.</p>

                <h3>Linking to Directional Light</h3>

                <p>The Sky Atmosphere needs to know which light represents the sun. By default, it auto-detects any Directional Light with <strong>Atmosphere Sun Light</strong> enabled. You can also manually specify the light in the Sky Atmosphere's "Atmosphere Sun Light" property.</p>

                <p>When properly linked:</p>
                <ul>
                    <li>Rotating the Directional Light changes sky colors (sunrise/sunset effects)</li>
                    <li>The sun disk appears in the sky matching the light direction</li>
                    <li>Aerial perspective matches the sun's position</li>
                </ul>

                <div class="card" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">
                    <h4>‚ö†Ô∏è Watch Out: Multiple Directional Lights</h4>
                    <p>If you have multiple Directional Lights with "Atmosphere Sun Light" enabled, the Sky Atmosphere may produce unexpected results or only respond to one. For most scenes, ensure only your main sun has this checkbox enabled.</p>
                </div>

                <h3>Creating Alien Atmospheres</h3>

                <p>By adjusting Rayleigh and Mie scattering colors, you can create non-Earth atmospheres:</p>

                <p><strong>Mars-like (thin, dusty):</strong> Reduce Rayleigh scale, increase Mie scale, use orange/brown Mie color</p>

                <p><strong>Thick alien atmosphere:</strong> Increase Atmosphere Height, boost Rayleigh scale, use exotic colors</p>

                <p><strong>No atmosphere (moon-like):</strong> Set scales very low, sky will be mostly black with visible sun disk</p>
            </section>

            <!-- Section 3: Exponential Height Fog -->
            <section id="height-fog" class="lesson-section">
                <h2>Exponential Height Fog</h2>

                <p><strong>Exponential Height Fog</strong> adds atmospheric depth to your scenes‚Äîthat sense of distance where faraway objects fade into haze. It simulates how air scatters light over distance, making environments feel vast and grounded in reality.</p>

                <h3>Adding Exponential Height Fog</h3>

                <p>Place Actors ‚Üí Visual Effects ‚Üí Exponential Height Fog</p>

                <p>Once placed, you'll immediately see fog affecting your scene. The fog density increases exponentially below a certain height (the "fog plane") and decreases above it.</p>

                <h3>Key Height Fog Settings</h3>

                <h4>Exponential Fog</h4>

                <p><strong>Fog Density:</strong> Overall thickness of the fog. Start low (0.01-0.02) and increase as needed. Even small values have significant visual impact.</p>

                <p><strong>Fog Height Falloff:</strong> How quickly fog decreases with altitude. Higher values = fog concentrated at ground level. Lower values = fog extends higher into the sky.</p>

                <p><strong>Fog Max Opacity:</strong> Maximum opacity the fog can reach at distance. Set below 1.0 to always see some detail in distant objects.</p>

                <p><strong>Start Distance:</strong> How far from camera before fog begins. Useful to keep nearby objects clear.</p>

                <!-- SVG: Height Fog Visualization -->
                <svg width="100%" height="220" viewBox="0 0 800 220" style="max-width: 800px; margin: 2rem auto; display: block; border: 2px solid #667eea; border-radius: 8px; background: linear-gradient(to bottom, #4a90c2 0%, #87ceeb 50%, #d4e8f7 80%, #e8e8e8 100%);">
                    <text x="400" y="25" text-anchor="middle" fill="#333" font-size="14" font-weight="bold">Exponential Height Fog Effect</text>
                    
                    <!-- Fog layers -->
                    <rect x="0" y="180" width="800" height="40" fill="rgba(200,200,200,0.9)"/>
                    <rect x="0" y="150" width="800" height="30" fill="rgba(200,200,200,0.6)"/>
                    <rect x="0" y="120" width="800" height="30" fill="rgba(200,200,200,0.3)"/>
                    <rect x="0" y="90" width="800" height="30" fill="rgba(200,200,200,0.1)"/>
                    
                    <!-- Mountains in distance (faded by fog) -->
                    <polygon points="600,200 700,100 800,200" fill="#4a6741" opacity="0.3"/>
                    <polygon points="500,200 620,80 740,200" fill="#5a7851" opacity="0.4"/>
                    <polygon points="350,200 480,110 610,200" fill="#6a8861" opacity="0.5"/>
                    
                    <!-- Trees closer (less fog) -->
                    <polygon points="150,200 180,140 210,200" fill="#2d5016" opacity="0.9"/>
                    <polygon points="100,200 130,150 160,200" fill="#3d6026" opacity="0.9"/>
                    
                    <!-- Height indicators -->
                    <line x1="50" y1="200" x2="50" y2="60" stroke="#333" stroke-width="1" stroke-dasharray="3,3"/>
                    <text x="40" y="200" text-anchor="end" fill="#333" font-size="9">Ground</text>
                    <text x="40" y="150" text-anchor="end" fill="#333" font-size="9">Fog plane</text>
                    <text x="40" y="90" text-anchor="end" fill="#333" font-size="9">Clear sky</text>
                    
                    <!-- Labels -->
                    <rect x="550" y="50" width="220" height="55" rx="5" fill="rgba(255,255,255,0.9)" stroke="#667eea"/>
                    <text x="660" y="70" text-anchor="middle" fill="#333" font-size="10">Fog Density: Thicker at ground</text>
                    <text x="660" y="85" text-anchor="middle" fill="#333" font-size="10">Height Falloff: Fades with altitude</text>
                    <text x="660" y="100" text-anchor="middle" fill="#333" font-size="10">Distance objects fade into haze</text>
                </svg>
                <p class="caption"><em>Figure: Exponential Height Fog creates depth by fading distant objects, concentrated at lower altitudes.</em></p>

                <h4>Fog Inscattering Color</h4>

                <p><strong>Fog Inscattering Color:</strong> The color of the fog itself. Match this to your sky/ambient color for natural results. Warm sunset scenes need warm fog; overcast days need gray fog.</p>

                <p><strong>Directional Inscattering Color:</strong> Color of fog when looking toward the sun. Creates that bright glow when you look toward the light source through fog.</p>

                <p><strong>Directional Inscattering Exponent:</strong> How tight the directional glow is. Higher values = more concentrated toward sun direction.</p>

                <h4>Volumetric Fog</h4>

                <p>Enable <strong>Volumetric Fog</strong> for dramatically improved fog quality, especially with local lights. Volumetric fog allows:</p>

                <ul>
                    <li>Light shafts (god rays) through fog</li>
                    <li>Local lights illuminating fog particles</li>
                    <li>Shadows within the fog volume</li>
                    <li>More physically accurate scattering</li>
                </ul>

                <p><strong>Volumetric Fog Scattering Distribution:</strong> Controls the forward-scattering of volumetric fog. Higher values create stronger light shafts.</p>

                <p><strong>Volumetric Fog Albedo:</strong> Color of the fog when illuminated by lights.</p>

                <p><strong>Volumetric Fog Extinction Scale:</strong> How quickly light is absorbed by the fog. Higher = denser fog.</p>

                <div class="card" style="background: #e8f5e9; border-left: 4px solid #4CAF50;">
                    <h4>‚úÖ Pro Tip: God Rays</h4>
                    <p>To achieve dramatic god rays (light shafts):</p>
                    <ol>
                        <li>Enable Volumetric Fog on your Exponential Height Fog</li>
                        <li>On your Directional Light, enable "Light Shaft Occlusion" and "Light Shaft Bloom"</li>
                        <li>Increase Fog Density slightly</li>
                        <li>Ensure sun is at a low angle (dawn/dusk work best)</li>
                        <li>Have some geometry (trees, buildings) to create partial occlusion</li>
                    </ol>
                </div>

                <h3>Fog and Performance</h3>

                <p>Standard exponential fog has minimal performance cost. However:</p>

                <p><strong>Volumetric Fog:</strong> Moderate to high cost depending on settings. The "View Distance" and "Volume Size" under Volumetric Fog settings control quality vs. performance.</p>

                <p>Reduce <strong>Volumetric Fog View Distance</strong> to limit the depth calculated. Reduce <strong>Volumetric Fog Detail</strong> (in scalability settings) for better performance at the cost of some visual quality.</p>
            </section>
            <!-- Section 4: SkyLight for Ambient Illumination -->
            <section id="skylight" class="lesson-section">
                <h2>SkyLight for Ambient Illumination</h2>

                <p>While the Directional Light provides direct sunlight and the Sky Atmosphere creates the visual sky, neither fully addresses <strong>ambient lighting</strong>‚Äîthe soft, omnidirectional light that fills shadows and illuminates areas not directly hit by the sun. That's where the <strong>SkyLight</strong> comes in.</p>

                <h3>What the SkyLight Does</h3>

                <p>The SkyLight captures the lighting from your sky (or a specified cubemap) and applies it as ambient illumination to your entire scene. Think of it as the light that comes from the entire sky dome, not just the sun. On a clear day, even objects in shadow are lit by blue light from the sky above.</p>

                <p>Without a SkyLight, shadows would be nearly black, and your scene would lack the subtle environmental lighting that makes outdoor environments feel natural.</p>

                <!-- SVG: SkyLight Concept -->
                <svg width="100%" height="240" viewBox="0 0 800 240" style="max-width: 800px; margin: 2rem auto; display: block; border: 2px solid #667eea; border-radius: 8px; background: linear-gradient(to bottom, #1a3a5c 0%, #4a90c2 40%, #87ceeb 100%);">
                    <text x="400" y="25" text-anchor="middle" fill="#fff" font-size="14" font-weight="bold">SkyLight: Ambient Illumination from the Sky</text>
                    
                    <!-- Sky dome arrows pointing inward -->
                    <g opacity="0.6">
                        <!-- Top -->
                        <line x1="400" y1="50" x2="400" y2="100" stroke="#87ceeb" stroke-width="2" marker-end="url(#skyArrow)"/>
                        <!-- Top left -->
                        <line x1="250" y1="70" x2="320" y2="110" stroke="#87ceeb" stroke-width="2" marker-end="url(#skyArrow)"/>
                        <!-- Top right -->
                        <line x1="550" y1="70" x2="480" y2="110" stroke="#87ceeb" stroke-width="2" marker-end="url(#skyArrow)"/>
                        <!-- Left -->
                        <line x1="150" y1="130" x2="250" y2="140" stroke="#a8d4f0" stroke-width="2" marker-end="url(#skyArrow)"/>
                        <!-- Right -->
                        <line x1="650" y1="130" x2="550" y2="140" stroke="#a8d4f0" stroke-width="2" marker-end="url(#skyArrow)"/>
                    </g>
                    
                    <defs>
                        <marker id="skyArrow" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                            <polygon points="0 0, 8 3, 0 6" fill="#87ceeb"/>
                        </marker>
                    </defs>
                    
                    <!-- Ground -->
                    <rect x="100" y="180" width="600" height="50" fill="#3d6026"/>
                    
                    <!-- Object in shadow -->
                    <rect x="350" y="140" width="100" height="40" fill="#667eea"/>
                    
                    <!-- Shadow area (but still lit by sky) -->
                    <rect x="450" y="175" width="80" height="5" fill="rgba(0,0,0,0.3)"/>
                    
                    <!-- Sun rays (direct light) -->
                    <circle cx="650" cy="80" r="20" fill="#f1c40f"/>
                    <line x1="630" y1="95" x2="450" y2="145" stroke="#f1c40f" stroke-width="2"/>
                    <line x1="630" y1="95" x2="350" y2="145" stroke="#f1c40f" stroke-width="2"/>
                    
                    <!-- Labels -->
                    <rect x="50" y="60" width="150" height="50" rx="5" fill="rgba(0,0,0,0.6)"/>
                    <text x="125" y="80" text-anchor="middle" fill="#87ceeb" font-size="10" font-weight="bold">SkyLight</text>
                    <text x="125" y="95" text-anchor="middle" fill="#aaa" font-size="9">Captures sky color</text>
                    <text x="125" y="108" text-anchor="middle" fill="#aaa" font-size="9">Illuminates shadows</text>
                    
                    <rect x="550" y="180" width="180" height="45" rx="5" fill="rgba(0,0,0,0.6)"/>
                    <text x="640" y="198" text-anchor="middle" fill="#fff" font-size="9">Shadow area still receives</text>
                    <text x="640" y="212" text-anchor="middle" fill="#87ceeb" font-size="9">blue ambient light from sky</text>
                </svg>
                <p class="caption"><em>Figure: The SkyLight provides ambient illumination from the entire sky, filling shadows with color.</em></p>

                <h3>Adding a SkyLight</h3>

                <p>Place Actors ‚Üí Lights ‚Üí SkyLight</p>

                <p>Position doesn't matter much for sky capture‚Äîthe SkyLight samples the entire sky hemisphere. However, you may want to place it at a memorable location for easy selection.</p>

                <h3>SkyLight Source Types</h3>

                <p>The SkyLight has two source modes:</p>

                <h4>SLS Captured Scene (Default)</h4>

                <p>The SkyLight captures the actual sky visible in your level‚Äîyour Sky Atmosphere, clouds, and surrounding environment. This is the most common and recommended mode for outdoor scenes.</p>

                <p><strong>Real Time Capture:</strong> When enabled, the SkyLight continuously updates to match sky changes. Essential for dynamic time-of-day. Has performance cost.</p>

                <p><strong>Recapture Sky:</strong> Button to manually update the capture. Use when Real Time Capture is off and you've changed the sky.</p>

                <h4>SLS Specified Cubemap</h4>

                <p>Instead of capturing the scene, use a pre-made cubemap texture for ambient lighting. Useful for:</p>
                <ul>
                    <li>Interior scenes with stylized lighting</li>
                    <li>Matching a specific reference image</li>
                    <li>Performance-critical scenarios where capture is too expensive</li>
                </ul>

                <p>When using a cubemap, assign it to the <strong>Cubemap</strong> property. The <strong>Source Cubemap Angle</strong> rotates the cubemap to align with your scene.</p>

                <h3>Key SkyLight Settings</h3>

                <h4>Light Section</h4>

                <p><strong>Intensity Scale:</strong> Multiplier for the captured sky's brightness. Adjust to balance ambient vs. direct light. Values around 1.0 are typical; increase for brighter ambient, decrease for more contrast.</p>

                <p><strong>Volumetric Scattering Intensity:</strong> How much this light contributes to volumetric fog. Increase for more ambient fog illumination.</p>

                <h4>Light Color</h4>

                <p><strong>Lower Hemisphere Is Solid Color:</strong> When enabled (default), the bottom half of the sky capture is replaced with a solid color. This prevents ground reflections from affecting your lighting‚Äîusually desirable for outdoor scenes.</p>

                <p><strong>Lower Hemisphere Color:</strong> The color used for the lower hemisphere. Match this roughly to your ground color for natural results (dark green for grass, brown for dirt, etc.).</p>

                <h4>Distance Field Ambient Occlusion</h4>

                <p><strong>DFAO</strong> uses mesh distance fields to add soft ambient occlusion specifically for skylight. This darkens crevices and areas where geometry meets, adding depth and grounding objects in the scene.</p>

                <p><strong>Occlusion Max Distance:</strong> How far the AO effect reaches. Higher values = softer, larger-scale occlusion.</p>

                <p><strong>Contrast:</strong> Sharpness of the occlusion effect.</p>

                <p><strong>Min Occlusion:</strong> Limits how dark AO can get. Keep above 0 to prevent pure black in corners.</p>

                <!-- Mermaid: SkyLight Configuration -->
                <pre class="mermaid">
flowchart TD
    A["Add SkyLight"] --> B{"Source Type?"}
    
    B -->|"Captured Scene"| C["Uses actual sky"]
    B -->|"Specified Cubemap"| D["Uses texture"]
    
    C --> E{"Dynamic sky?"}
    E -->|"Yes"| F["Enable Real Time Capture"]
    E -->|"No"| G["Capture once, disable real-time"]
    
    D --> H["Assign cubemap texture"]
    
    F --> I["Configure Intensity"]
    G --> I
    H --> I
    
    I --> J["Set Lower Hemisphere Color"]
    J --> K["Enable DFAO for grounding"]
    
    style A fill:#667eea,color:#fff
    style K fill:#4CAF50,color:#fff
                </pre>
                <p class="caption"><em>Figure: SkyLight configuration workflow based on your scene's needs.</em></p>

                <h3>SkyLight Mobility</h3>

                <p><strong>Static:</strong> Captures sky once during lighting build. Zero runtime cost. Cannot update for time-of-day changes.</p>

                <p><strong>Stationary:</strong> Same as Static for SkyLights. Baked during lighting build.</p>

                <p><strong>Movable:</strong> Can update at runtime. Required for Real Time Capture. Higher performance cost but necessary for dynamic skies.</p>

                <div class="card" style="background: #e8f5e9; border-left: 4px solid #4CAF50;">
                    <h4>‚úÖ Pro Tip: SkyLight Recapture Optimization</h4>
                    <p>Real Time Capture on SkyLight can be expensive. For time-of-day systems, consider:</p>
                    <ul>
                        <li>Capturing only every few seconds instead of every frame</li>
                        <li>Using Blueprint to call "Recapture Sky" at specific intervals</li>
                        <li>Blending between pre-captured cubemaps for different times of day</li>
                    </ul>
                </div>

                <h3>SkyLight vs. Lumen</h3>

                <p>With <strong>Lumen</strong> enabled, you might wonder if SkyLight is still necessary. The answer is nuanced:</p>

                <p><strong>Lumen handles GI</strong> from all lights, including sky contribution through the atmosphere. In pure Lumen workflows, some developers skip the SkyLight entirely.</p>

                <p>However, <strong>SkyLight still adds value</strong>:</p>
                <ul>
                    <li>Provides faster ambient response than Lumen's GI propagation</li>
                    <li>DFAO from SkyLight works independently and can enhance Lumen's AO</li>
                    <li>Easier artistic control over ambient color</li>
                    <li>Fallback if Lumen has issues in certain areas</li>
                </ul>

                <p>For most outdoor scenes, including a SkyLight alongside Lumen produces the most robust and visually pleasing results.</p>
            </section>

            <!-- Section 5: Time-of-Day Setups -->
            <section id="time-of-day" class="lesson-section">
                <h2>Time-of-Day Setups</h2>

                <p>Dynamic time-of-day systems‚Äîwhere the sun moves across the sky, colors shift from dawn to dusk to night‚Äîcreate immersive, living worlds. Unreal Engine 5 with Lumen makes this easier than ever, with real-time global illumination that responds instantly to sun position changes.</p>

                <h3>Components of a Time-of-Day System</h3>

                <p>A complete time-of-day system typically includes:</p>

                <ol>
                    <li><strong>Directional Light (Movable):</strong> Represents the sun, rotates through the day</li>
                    <li><strong>Sky Atmosphere:</strong> Updates sky colors based on sun position</li>
                    <li><strong>SkyLight (Movable + Real Time Capture):</strong> Updates ambient to match sky</li>
                    <li><strong>Exponential Height Fog:</strong> Color/density may change with time</li>
                    <li><strong>Post Process:</strong> Exposure and color grading adjustments</li>
                    <li><strong>Blueprint/Controller:</strong> Drives the rotation over time</li>
                </ol>

                <!-- SVG: Time of Day Components -->
                <svg width="100%" height="300" viewBox="0 0 850 300" style="max-width: 850px; margin: 2rem auto; display: block; border: 2px solid #667eea; border-radius: 8px; background: #1e1e1e;">
                    <text x="425" y="30" text-anchor="middle" fill="#fff" font-size="16" font-weight="bold">Time-of-Day System Architecture</text>
                    
                    <!-- Central Controller -->
                    <g transform="translate(350, 100)">
                        <rect x="0" y="0" width="150" height="60" rx="8" fill="#667eea" stroke="#8899ee" stroke-width="2"/>
                        <text x="75" y="25" text-anchor="middle" fill="#fff" font-size="11" font-weight="bold">Time Controller</text>
                        <text x="75" y="42" text-anchor="middle" fill="#ccc" font-size="9">Blueprint/Actor</text>
                        <text x="75" y="55" text-anchor="middle" fill="#aaa" font-size="8">Time of Day value</text>
                    </g>
                    
                    <!-- Directional Light -->
                    <g transform="translate(50, 60)">
                        <rect x="0" y="0" width="130" height="50" rx="5" fill="#f1c40f" opacity="0.2" stroke="#f1c40f" stroke-width="2"/>
                        <text x="65" y="20" text-anchor="middle" fill="#f1c40f" font-size="10" font-weight="bold">‚òÄÔ∏è Directional Light</text>
                        <text x="65" y="35" text-anchor="middle" fill="#aaa" font-size="8">Rotation, Color, Intensity</text>
                        <text x="65" y="47" text-anchor="middle" fill="#888" font-size="7">Movable</text>
                    </g>
                    
                    <!-- Sky Atmosphere -->
                    <g transform="translate(50, 130)">
                        <rect x="0" y="0" width="130" height="50" rx="5" fill="#87ceeb" opacity="0.2" stroke="#87ceeb" stroke-width="2"/>
                        <text x="65" y="20" text-anchor="middle" fill="#87ceeb" font-size="10" font-weight="bold">üå§Ô∏è Sky Atmosphere</text>
                        <text x="65" y="35" text-anchor="middle" fill="#aaa" font-size="8">Auto-updates with sun</text>
                        <text x="65" y="47" text-anchor="middle" fill="#888" font-size="7">Linked to Directional</text>
                    </g>
                    
                    <!-- SkyLight -->
                    <g transform="translate(50, 200)">
                        <rect x="0" y="0" width="130" height="50" rx="5" fill="#4CAF50" opacity="0.2" stroke="#4CAF50" stroke-width="2"/>
                        <text x="65" y="20" text-anchor="middle" fill="#4CAF50" font-size="10" font-weight="bold">üí° SkyLight</text>
                        <text x="65" y="35" text-anchor="middle" fill="#aaa" font-size="8">Real Time Capture</text>
                        <text x="65" y="47" text-anchor="middle" fill="#888" font-size="7">Movable</text>
                    </g>
                    
                    <!-- Fog -->
                    <g transform="translate(670, 60)">
                        <rect x="0" y="0" width="130" height="50" rx="5" fill="#9C27B0" opacity="0.2" stroke="#9C27B0" stroke-width="2"/>
                        <text x="65" y="20" text-anchor="middle" fill="#9C27B0" font-size="10" font-weight="bold">üå´Ô∏è Height Fog</text>
                        <text x="65" y="35" text-anchor="middle" fill="#aaa" font-size="8">Color, Density</text>
                        <text x="65" y="47" text-anchor="middle" fill="#888" font-size="7">Optional animation</text>
                    </g>
                    
                    <!-- Post Process -->
                    <g transform="translate(670, 130)">
                        <rect x="0" y="0" width="130" height="50" rx="5" fill="#FF9800" opacity="0.2" stroke="#FF9800" stroke-width="2"/>
                        <text x="65" y="20" text-anchor="middle" fill="#FF9800" font-size="10" font-weight="bold">üé® Post Process</text>
                        <text x="65" y="35" text-anchor="middle" fill="#aaa" font-size="8">Exposure, Color Grade</text>
                        <text x="65" y="47" text-anchor="middle" fill="#888" font-size="7">Unbound volume</text>
                    </g>
                    
                    <!-- Moon (night) -->
                    <g transform="translate(670, 200)">
                        <rect x="0" y="0" width="130" height="50" rx="5" fill="#607D8B" opacity="0.2" stroke="#607D8B" stroke-width="2"/>
                        <text x="65" y="20" text-anchor="middle" fill="#607D8B" font-size="10" font-weight="bold">üåô Moon (Optional)</text>
                        <text x="65" y="35" text-anchor="middle" fill="#aaa" font-size="8">Second Directional</text>
                        <text x="65" y="47" text-anchor="middle" fill="#888" font-size="7">Opposite sun rotation</text>
                    </g>
                    
                    <!-- Connection lines -->
                    <line x1="350" y1="130" x2="180" y2="85" stroke="#888" stroke-width="1"/>
                    <line x1="350" y1="130" x2="180" y2="155" stroke="#888" stroke-width="1"/>
                    <line x1="350" y1="130" x2="180" y2="225" stroke="#888" stroke-width="1"/>
                    <line x1="500" y1="130" x2="670" y2="85" stroke="#888" stroke-width="1"/>
                    <line x1="500" y1="130" x2="670" y2="155" stroke="#888" stroke-width="1"/>
                    <line x1="500" y1="130" x2="670" y2="225" stroke="#888" stroke-width="1"/>
                    
                    <!-- Bottom note -->
                    <rect x="200" y="260" width="450" height="30" rx="5" fill="rgba(102,126,234,0.2)" stroke="#667eea"/>
                    <text x="425" y="280" text-anchor="middle" fill="#fff" font-size="10">Time Controller drives all components ‚Ä¢ Lumen provides real-time GI response</text>
                </svg>
                <p class="caption"><em>Figure: A time-of-day system coordinates multiple lighting components through a central controller.</em></p>

                <h3>Basic Time-of-Day Blueprint</h3>

                <p>The simplest approach rotates the Directional Light over time. Here's the conceptual setup:</p>

                <p><strong>Step 1:</strong> Create a new Actor Blueprint (call it <code>BP_TimeOfDayController</code>).</p>

                <p><strong>Step 2:</strong> Add a variable <code>TimeOfDay</code> (Float, 0-24 representing hours).</p>

                <p><strong>Step 3:</strong> Add a variable <code>SunLight</code> (Directional Light Component reference or actor reference).</p>

                <p><strong>Step 4:</strong> In the Event Graph, on Event Tick (or a timer for better performance):</p>
                <ul>
                    <li>Increment TimeOfDay by Delta Time √ó Speed multiplier</li>
                    <li>Wrap TimeOfDay to stay within 0-24</li>
                    <li>Convert TimeOfDay to sun rotation: <code>Pitch = (TimeOfDay / 24) √ó 360 - 90</code></li>
                    <li>Apply rotation to the Directional Light</li>
                </ul>

                <p><strong>Step 5:</strong> Optionally, create curves for sun color, intensity, fog color that sample based on TimeOfDay.</p>

                <!-- SVG: Blueprint Node Concept -->
                <svg width="100%" height="200" viewBox="0 0 800 200" style="max-width: 800px; margin: 2rem auto; display: block; border: 2px solid #667eea; border-radius: 8px; background: #2d2d2d;">
                    <text x="400" y="25" text-anchor="middle" fill="#fff" font-size="14" font-weight="bold">Time-of-Day Blueprint Logic (Simplified)</text>
                    
                    <!-- Event Tick -->
                    <g transform="translate(30, 50)">
                        <rect x="0" y="0" width="100" height="50" rx="5" fill="#8b0000" stroke="#ff4444"/>
                        <text x="50" y="20" text-anchor="middle" fill="#fff" font-size="9" font-weight="bold">Event Tick</text>
                        <text x="50" y="35" text-anchor="middle" fill="#aaa" font-size="8">Delta Seconds</text>
                        <circle cx="100" cy="25" r="5" fill="#fff"/>
                        <circle cx="100" cy="40" r="5" fill="#4CAF50"/>
                    </g>
                    
                    <!-- Increment Time -->
                    <g transform="translate(170, 45)">
                        <rect x="0" y="0" width="120" height="60" rx="5" fill="#3d3d3d" stroke="#888"/>
                        <text x="60" y="18" text-anchor="middle" fill="#fff" font-size="9">Add</text>
                        <text x="60" y="35" text-anchor="middle" fill="#aaa" font-size="8">TimeOfDay +</text>
                        <text x="60" y="48" text-anchor="middle" fill="#aaa" font-size="8">(Delta √ó Speed)</text>
                        <circle cx="0" cy="30" r="5" fill="#4CAF50"/>
                        <circle cx="120" cy="30" r="5" fill="#4CAF50"/>
                    </g>
                    
                    <!-- Wire -->
                    <line x1="130" y1="75" x2="170" y2="75" stroke="#fff" stroke-width="2"/>
                    <line x1="130" y1="90" x2="150" y2="90" x2="150" y2="75" stroke="#4CAF50" stroke-width="2"/>
                    
                    <!-- Modulo 24 -->
                    <g transform="translate(330, 45)">
                        <rect x="0" y="0" width="100" height="60" rx="5" fill="#3d3d3d" stroke="#888"/>
                        <text x="50" y="18" text-anchor="middle" fill="#fff" font-size="9">Modulo</text>
                        <text x="50" y="35" text-anchor="middle" fill="#aaa" font-size="8">% 24</text>
                        <text x="50" y="48" text-anchor="middle" fill="#888" font-size="7">(Wrap hours)</text>
                        <circle cx="0" cy="30" r="5" fill="#4CAF50"/>
                        <circle cx="100" cy="30" r="5" fill="#4CAF50"/>
                    </g>
                    
                    <line x1="290" y1="75" x2="330" y2="75" stroke="#4CAF50" stroke-width="2"/>
                    
                    <!-- Calculate Rotation -->
                    <g transform="translate(470, 45)">
                        <rect x="0" y="0" width="130" height="60" rx="5" fill="#3d3d3d" stroke="#888"/>
                        <text x="65" y="18" text-anchor="middle" fill="#fff" font-size="9">Make Rotator</text>
                        <text x="65" y="35" text-anchor="middle" fill="#aaa" font-size="8">Pitch = Time√ó15-90</text>
                        <text x="65" y="48" text-anchor="middle" fill="#888" font-size="7">(Maps 0-24 to angles)</text>
                        <circle cx="0" cy="30" r="5" fill="#4CAF50"/>
                        <circle cx="130" cy="30" r="5" fill="#f1c40f"/>
                    </g>
                    
                    <line x1="430" y1="75" x2="470" y2="75" stroke="#4CAF50" stroke-width="2"/>
                    
                    <!-- Set Rotation -->
                    <g transform="translate(640, 45)">
                        <rect x="0" y="0" width="130" height="60" rx="5" fill="#1565c0" stroke="#2196F3"/>
                        <text x="65" y="18" text-anchor="middle" fill="#fff" font-size="9" font-weight="bold">Set World Rotation</text>
                        <text x="65" y="35" text-anchor="middle" fill="#aaa" font-size="8">Target: Sun Light</text>
                        <circle cx="0" cy="25" r="5" fill="#fff"/>
                        <circle cx="0" cy="45" r="5" fill="#f1c40f"/>
                    </g>
                    
                    <line x1="600" y1="75" x2="640" y2="90" stroke="#f1c40f" stroke-width="2"/>
                    
                    <!-- Bottom explanation -->
                    <rect x="100" y="140" width="600" height="45" rx="5" fill="rgba(255,255,255,0.05)"/>
                    <text x="400" y="160" text-anchor="middle" fill="#aaa" font-size="10">Each tick: Advance time ‚Üí Wrap to 0-24 ‚Üí Convert to rotation ‚Üí Apply to sun</text>
                    <text x="400" y="178" text-anchor="middle" fill="#888" font-size="9">For production, use Timeline or interpolation for smoother results</text>
                </svg>
                <p class="caption"><em>Figure: Conceptual Blueprint flow for rotating the sun based on time of day.</em></p>

                <h3>Using Curves for Smooth Transitions</h3>

                <p>Rather than calculating everything mathematically, Unreal's <strong>Curve assets</strong> let you define smooth, artist-friendly transitions:</p>

                <p><strong>Float Curve:</strong> For single values (sun intensity, fog density)</p>
                <p><strong>Color Curve:</strong> For colors (sun color, fog inscattering color)</p>

                <p>Create curve assets in Content Browser (right-click ‚Üí Miscellaneous ‚Üí Curve). Plot values across the 0-24 hour range, then sample the curve in Blueprint using <code>Get Float Value</code> or <code>Get Linear Color Value</code> with your TimeOfDay as the input.</p>

                <p>This approach gives artists direct control over the feel of each time of day without touching Blueprint logic.</p>

                <h3>Night Considerations</h3>

                <p>When the sun drops below the horizon (TimeOfDay roughly 18:00-6:00), you'll need to handle:</p>

                <p><strong>Moon Light:</strong> Add a second Directional Light for moonlight. Rotate it opposite to the sun. Much dimmer (1-5% of sun intensity), cooler color (slight blue tint).</p>

                <p><strong>Stars:</strong> Use a star texture/mesh behind the Sky Atmosphere, or a dedicated star sphere. Fade in as sky darkens.</p>

                <p><strong>Artificial Lights:</strong> Street lights, building windows, etc. should turn on at dusk. Use visibility or intensity curves keyed to TimeOfDay.</p>

                <p><strong>Exposure:</strong> Auto-exposure will try to brighten the dark scene. Consider exposure compensation curves or switching to manual exposure at night.</p>

                <div class="card" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">
                    <h4>‚ö†Ô∏è Watch Out: Lighting Build and Time-of-Day</h4>
                    <p>If you're using <strong>baked lighting</strong> (Static/Stationary lights), you cannot have true dynamic time-of-day‚Äîthe baked lighting is fixed to whatever sun position existed during the build. For dynamic time-of-day, you must use:</p>
                    <ul>
                        <li>Movable Directional Light</li>
                        <li>Lumen (for dynamic GI)</li>
                        <li>Movable SkyLight with Real Time Capture</li>
                    </ul>
                </div>

                <h3>Performance Optimization for Time-of-Day</h3>

                <p><strong>SkyLight Capture Frequency:</strong> Real Time Capture every frame is expensive. Capture every 0.5-1 seconds, or only when the time changes significantly.</p>

                <p><strong>Lumen Quality Settings:</strong> Reduce Lumen quality for faster GI updates during rapid time changes. Return to higher quality when time is stable.</p>

                <p><strong>Level of Detail:</strong> Distant objects that depend on lighting can use lower shadow quality or simplified materials.</p>

                <p><strong>Time Speed:</strong> Very fast time progression (minute = real second) is harder on performance than slow progression. Consider capping progression speed or using time-skip transitions.</p>

                <!-- Mermaid: Time of Day Performance -->
                <pre class="mermaid">
flowchart TD
    A["Time-of-Day Active"] --> B{"Performance Target?"}
    
    B -->|"High-End"| C["Full Lumen<br/>Real-time SkyLight<br/>Every-frame update"]
    B -->|"Mid-Range"| D["Lumen Software RT<br/>Periodic SkyLight capture<br/>0.5s intervals"]
    B -->|"Performance Critical"| E["Lower Lumen quality<br/>Blend cubemaps<br/>Pre-calculated colors"]
    
    C --> F["Best visual quality"]
    D --> G["Good balance"]
    E --> H["Stable frame rate"]
    
    style C fill:#4CAF50,color:#fff
    style D fill:#FF9800,color:#fff
    style E fill:#f44336,color:#fff
                </pre>
                <p class="caption"><em>Figure: Balance time-of-day visual quality with performance targets.</em></p>
            </section>
            <!-- Section 6: Hands-On Exercise -->
            <section id="hands-on" class="lesson-section">
                <h2>Hands-On: Set Up an Outdoor Daytime Sky</h2>

                <p>Time to put everything together! In this exercise, you'll create a complete outdoor lighting setup from scratch‚Äîa sunny afternoon scene with realistic sky, atmospheric fog, and proper ambient lighting. By the end, you'll have a reusable template for outdoor environments.</p>

                <div class="card" style="background: #e3f2fd; border-left: 4px solid #2196F3;">
                    <h3>üèãÔ∏è Exercise: Sunny Afternoon Environment</h3>
                    
                    <p><strong>Goal:</strong> Create a complete outdoor lighting setup with sun, sky, fog, and ambient light.</p>
                    
                    <p><strong>Time:</strong> 20-30 minutes</p>
                    
                    <p><strong>What you'll practice:</strong></p>
                    <ul>
                        <li>Configuring a Directional Light as the sun</li>
                        <li>Setting up Sky Atmosphere for realistic sky rendering</li>
                        <li>Adding Exponential Height Fog for depth</li>
                        <li>Configuring SkyLight for ambient illumination</li>
                        <li>Fine-tuning the overall lighting balance</li>
                    </ul>
                </div>

                <h3>Part 1: Create a New Level</h3>

                <p><strong>Step 1:</strong> Create a new level: File ‚Üí New Level ‚Üí Empty Level. Save it as <code>L_OutdoorLighting_Test</code>.</p>

                <p><strong>Step 2:</strong> Add some ground geometry so we have surfaces to see lighting on. Place a large plane or landscape:</p>
                <ul>
                    <li>Quick option: Place Actors ‚Üí Basic ‚Üí Plane. Scale it to (100, 100, 1).</li>
                    <li>Better option: Create a simple Landscape (Landscape Mode ‚Üí Create New).</li>
                </ul>

                <p><strong>Step 3:</strong> Add some vertical geometry for shadow testing. Place a few cubes or cylinders at different positions. These will help us see how shadows fall.</p>

                <p><strong>Step 4:</strong> Apply a basic material to your geometry so it's not default gray. A simple grass or ground texture works well.</p>

                <details style="margin: 1rem 0; padding: 1rem; background: #f5f5f5; border-radius: 8px; border: 1px solid #ddd;">
                    <summary style="cursor: pointer; font-weight: bold; color: #667eea;">üí° Hint: Quick Ground Setup</summary>
                    <p style="margin-top: 1rem;">If you have Starter Content enabled, you can use <code>M_Ground_Grass</code> material on your plane. Otherwise, create a simple material with a green base color (0.1, 0.3, 0.05) and roughness around 0.8.</p>
                </details>

                <h3>Part 2: Add the Directional Light (Sun)</h3>

                <p><strong>Step 5:</strong> Place Actors ‚Üí Lights ‚Üí Directional Light. This will be our sun.</p>

                <p><strong>Step 6:</strong> Select the Directional Light and configure these settings in the Details panel:</p>

                <p><strong>Transform:</strong></p>
                <ul>
                    <li>Rotation: Pitch = <code>-45</code>, Yaw = <code>-45</code> (afternoon sun from the southwest)</li>
                </ul>

                <p><strong>Light:</strong></p>
                <ul>
                    <li>Intensity: <code>10 lux</code> (or leave default if using auto-exposure)</li>
                    <li>Light Color: Warm white ‚Äî click the color, set to roughly (255, 250, 235) or use Temperature</li>
                    <li>Use Temperature: Enable, set to <code>5800 K</code> (warm afternoon sun)</li>
                    <li>Source Angle: <code>1.0</code> (slightly soft shadows)</li>
                </ul>

                <p><strong>Atmosphere and Cloud:</strong></p>
                <ul>
                    <li>Atmosphere Sun Light: <code>‚úì Enabled</code> (critical!)</li>
                </ul>

                <p><strong>Cascaded Shadow Maps:</strong></p>
                <ul>
                    <li>Dynamic Shadow Distance: <code>20000</code> (200 meters)</li>
                    <li>Num Dynamic Shadow Cascades: <code>4</code></li>
                </ul>

                <p><strong>Mobility:</strong></p>
                <ul>
                    <li>Set to <code>Movable</code> (for Lumen compatibility) or <code>Stationary</code> (for baked GI)</li>
                </ul>

                <p><strong>Step 7:</strong> Verify the light direction by looking at shadows on your geometry. Adjust rotation with <strong>Ctrl+L drag</strong> if needed.</p>

                <!-- SVG: Sun Setup Checklist -->
                <svg width="100%" height="180" viewBox="0 0 700 180" style="max-width: 700px; margin: 2rem auto; display: block; border: 2px solid #667eea; border-radius: 8px; background: #f9f9f9;">
                    <text x="350" y="25" text-anchor="middle" fill="#333" font-size="14" font-weight="bold">Directional Light Setup Checklist</text>
                    
                    <g transform="translate(50, 45)">
                        <rect x="0" y="0" width="280" height="120" rx="8" fill="#fff" stroke="#4CAF50" stroke-width="2"/>
                        <text x="140" y="25" text-anchor="middle" fill="#4CAF50" font-size="11" font-weight="bold">‚úì Essential Settings</text>
                        
                        <text x="15" y="50" fill="#333" font-size="10">‚òë Rotation set (Pitch -45¬∞)</text>
                        <text x="15" y="68" fill="#333" font-size="10">‚òë Atmosphere Sun Light enabled</text>
                        <text x="15" y="86" fill="#333" font-size="10">‚òë Temperature ~5800K</text>
                        <text x="15" y="104" fill="#333" font-size="10">‚òë Mobility: Movable or Stationary</text>
                    </g>
                    
                    <g transform="translate(370, 45)">
                        <rect x="0" y="0" width="280" height="120" rx="8" fill="#fff" stroke="#FF9800" stroke-width="2"/>
                        <text x="140" y="25" text-anchor="middle" fill="#FF9800" font-size="11" font-weight="bold">‚öôÔ∏è Recommended Tweaks</text>
                        
                        <text x="15" y="50" fill="#333" font-size="10">‚óã Source Angle: 1.0 for soft shadows</text>
                        <text x="15" y="68" fill="#333" font-size="10">‚óã Shadow Cascades: 4</text>
                        <text x="15" y="86" fill="#333" font-size="10">‚óã Cast Shadows: Enabled</text>
                        <text x="15" y="104" fill="#333" font-size="10">‚óã Shadow Distance: 20000+</text>
                    </g>
                </svg>

                <h3>Part 3: Add Sky Atmosphere</h3>

                <p><strong>Step 8:</strong> Place Actors ‚Üí Visual Effects ‚Üí Sky Atmosphere.</p>

                <p><strong>Step 9:</strong> Immediately, you should see a blue sky appear! The Sky Atmosphere automatically connects to your Directional Light (because we enabled Atmosphere Sun Light).</p>

                <p><strong>Step 10:</strong> Configure Sky Atmosphere settings (most defaults are good, but verify):</p>

                <p><strong>Atmosphere:</strong></p>
                <ul>
                    <li>Ground Radius: <code>6360</code> km (Earth default)</li>
                    <li>Atmosphere Height: <code>60</code> km (Earth default)</li>
                </ul>

                <p><strong>Rayleigh Scattering:</strong></p>
                <ul>
                    <li>Rayleigh Scattering Scale: <code>1.0</code> (default)</li>
                </ul>

                <p><strong>Mie Scattering:</strong></p>
                <ul>
                    <li>Mie Scattering Scale: <code>0.003996</code> (default) ‚Äî increase slightly for hazier atmosphere</li>
                    <li>Mie Anisotropy: <code>0.8</code> (default) ‚Äî controls sun halo tightness</li>
                </ul>

                <p><strong>Step 11:</strong> Test by rotating your Directional Light. Watch how the sky colors change as you move the sun toward the horizon (sunset colors) or overhead (blue sky).</p>

                <details style="margin: 1rem 0; padding: 1rem; background: #e8f5e9; border-radius: 8px; border: 1px solid #4CAF50;">
                    <summary style="cursor: pointer; font-weight: bold; color: #4CAF50;">‚úÖ Checkpoint: What You Should See</summary>
                    <div style="margin-top: 1rem;">
                        <p>At this point, you should have:</p>
                        <ul>
                            <li>A visible sun disk in the sky matching your Directional Light rotation</li>
                            <li>Blue sky with gradient from horizon to zenith</li>
                            <li>Warm colors near the sun position</li>
                            <li>Direct shadows from your geometry</li>
                        </ul>
                        <p>If the sky is black or the sun isn't visible, check that "Atmosphere Sun Light" is enabled on your Directional Light.</p>
                    </div>
                </details>

                <h3>Part 4: Add Exponential Height Fog</h3>

                <p><strong>Step 12:</strong> Place Actors ‚Üí Visual Effects ‚Üí Exponential Height Fog.</p>

                <p><strong>Step 13:</strong> Configure the fog settings:</p>

                <p><strong>Exponential Height Fog:</strong></p>
                <ul>
                    <li>Fog Density: <code>0.02</code> (start subtle)</li>
                    <li>Fog Height Falloff: <code>0.2</code></li>
                    <li>Fog Max Opacity: <code>0.9</code></li>
                    <li>Start Distance: <code>1000</code> (keep nearby objects clear)</li>
                </ul>

                <p><strong>Fog Inscattering Color:</strong></p>
                <ul>
                    <li>Set to a light blue-gray: (180, 200, 220) or sample from your sky at the horizon</li>
                </ul>

                <p><strong>Directional Inscattering:</strong></p>
                <ul>
                    <li>Directional Inscattering Exponent: <code>8</code></li>
                    <li>Directional Inscattering Start Distance: <code>10000</code></li>
                    <li>Directional Inscattering Color: Warm white matching sun</li>
                </ul>

                <p><strong>Volumetric Fog (Optional but recommended):</strong></p>
                <ul>
                    <li>Volumetric Fog: <code>‚úì Enabled</code></li>
                    <li>Scattering Distribution: <code>0.9</code></li>
                    <li>Albedo: White (1, 1, 1)</li>
                </ul>

                <p><strong>Step 14:</strong> Look at your scene. Distant objects should now fade slightly into atmospheric haze, adding depth perception.</p>

                <h3>Part 5: Add SkyLight</h3>

                <p><strong>Step 15:</strong> Place Actors ‚Üí Lights ‚Üí SkyLight.</p>

                <p><strong>Step 16:</strong> Configure the SkyLight:</p>

                <p><strong>Light:</strong></p>
                <ul>
                    <li>Source Type: <code>SLS Captured Scene</code></li>
                    <li>Intensity Scale: <code>1.0</code></li>
                    <li>Real Time Capture: <code>‚úì Enabled</code> (if using Movable sun)</li>
                </ul>

                <p><strong>Light Color:</strong></p>
                <ul>
                    <li>Lower Hemisphere Is Solid Color: <code>‚úì Enabled</code></li>
                    <li>Lower Hemisphere Color: Dark green (0.05, 0.1, 0.03) to simulate ground bounce</li>
                </ul>

                <p><strong>Distance Field Ambient Occlusion:</strong></p>
                <ul>
                    <li>Cast DFAO (if available): <code>‚úì Enabled</code></li>
                    <li>Occlusion Max Distance: <code>500</code></li>
                </ul>

                <p><strong>Mobility:</strong></p>
                <ul>
                    <li>Set to <code>Movable</code> (required for Real Time Capture)</li>
                </ul>

                <p><strong>Step 17:</strong> If Real Time Capture is off or Mobility is Static/Stationary, click <strong>Recapture Sky</strong> button to update the capture.</p>

                <h3>Part 6: Verify and Fine-Tune</h3>

                <p><strong>Step 18:</strong> Walk around your scene and observe:</p>
                <ul>
                    <li>Do shadows look natural? (Adjust sun Source Angle if too harsh)</li>
                    <li>Are shadow areas too dark? (Increase SkyLight Intensity Scale)</li>
                    <li>Is the scene too bright/washed out? (Check auto-exposure or reduce light intensities)</li>
                    <li>Does distance fade feel right? (Adjust fog density)</li>
                </ul>

                <p><strong>Step 19:</strong> Test different sun positions using Ctrl+L drag. Notice how Sky Atmosphere and SkyLight respond.</p>

                <p><strong>Step 20:</strong> If using Lumen, observe how indirect light fills shadows and bounces color. If not using Lumen, consider building lighting (Build ‚Üí Build Lighting Only) to see baked indirect lighting.</p>

                <!-- SVG: Final Setup Diagram -->
                <svg width="100%" height="260" viewBox="0 0 800 260" style="max-width: 800px; margin: 2rem auto; display: block; border: 2px solid #667eea; border-radius: 8px; background: linear-gradient(to bottom, #4a90c2 0%, #87ceeb 40%, #d4e8f7 70%, #3d6026 90%, #2d5016 100%);">
                    <text x="400" y="25" text-anchor="middle" fill="#fff" font-size="14" font-weight="bold">Complete Outdoor Lighting Setup</text>
                    
                    <!-- Sun -->
                    <circle cx="600" cy="80" r="30" fill="#f1c40f"/>
                    <circle cx="600" cy="80" r="35" fill="none" stroke="#f1c40f" stroke-width="2" opacity="0.5"/>
                    <text x="600" y="130" text-anchor="middle" fill="#fff" font-size="10" font-weight="bold">‚òÄÔ∏è Directional Light</text>
                    
                    <!-- Sun rays -->
                    <line x1="570" y1="95" x2="400" y2="180" stroke="#f1c40f" stroke-width="2" opacity="0.6"/>
                    <line x1="570" y1="95" x2="300" y2="200" stroke="#f1c40f" stroke-width="2" opacity="0.6"/>
                    <line x1="570" y1="95" x2="500" y2="200" stroke="#f1c40f" stroke-width="2" opacity="0.6"/>
                    
                    <!-- SkyLight arrows -->
                    <g opacity="0.4">
                        <line x1="200" y1="60" x2="300" y2="150" stroke="#87ceeb" stroke-width="2"/>
                        <line x1="400" y1="50" x2="400" y2="150" stroke="#87ceeb" stroke-width="2"/>
                        <line x1="300" y1="100" x2="350" y2="170" stroke="#87ceeb" stroke-width="2"/>
                    </g>
                    <text x="150" y="70" fill="#fff" font-size="10">üí° SkyLight (ambient)</text>
                    
                    <!-- Fog layer -->
                    <rect x="0" y="180" width="800" height="30" fill="rgba(200,210,220,0.4)"/>
                    <text x="100" y="200" fill="#333" font-size="10">üå´Ô∏è Height Fog</text>
                    
                    <!-- Ground objects -->
                    <rect x="280" y="170" width="40" height="40" fill="#667eea"/>
                    <rect x="350" y="175" width="30" height="35" fill="#667eea"/>
                    <rect x="450" y="165" width="50" height="45" fill="#667eea"/>
                    
                    <!-- Shadows -->
                    <polygon points="320,210 320,215 380,215 380,210" fill="rgba(0,0,0,0.3)"/>
                    <polygon points="380,210 380,215 420,215 420,210" fill="rgba(0,0,0,0.3)"/>
                    <polygon points="500,210 500,215 570,215 570,210" fill="rgba(0,0,0,0.3)"/>
                    
                    <!-- Labels -->
                    <rect x="50" y="220" width="200" height="30" rx="5" fill="rgba(0,0,0,0.6)"/>
                    <text x="150" y="240" text-anchor="middle" fill="#4CAF50" font-size="10">üå§Ô∏è Sky Atmosphere creates sky colors</text>
                    
                    <rect x="550" y="220" width="200" height="30" rx="5" fill="rgba(0,0,0,0.6)"/>
                    <text x="650" y="240" text-anchor="middle" fill="#f1c40f" font-size="10">Direct light + dynamic shadows</text>
                </svg>
                <p class="caption"><em>Figure: Your completed outdoor lighting setup with all four components working together.</em></p>

                <details style="margin: 1rem 0; padding: 1rem; background: #fff3cd; border-radius: 8px; border: 1px solid #ffc107;">
                    <summary style="cursor: pointer; font-weight: bold; color: #856404;">üîß Troubleshooting: Common Issues</summary>
                    <div style="margin-top: 1rem;">
                        <p><strong>Sky is black or missing:</strong></p>
                        <ul>
                            <li>Ensure Sky Atmosphere is placed in the level</li>
                            <li>Check "Atmosphere Sun Light" is enabled on Directional Light</li>
                            <li>Verify Directional Light isn't pointed straight down (sun below horizon)</li>
                        </ul>
                        
                        <p><strong>Scene is too dark:</strong></p>
                        <ul>
                            <li>Increase Directional Light intensity</li>
                            <li>Increase SkyLight Intensity Scale</li>
                            <li>Check if auto-exposure is underexposing (add Post Process Volume with fixed exposure)</li>
                        </ul>
                        
                        <p><strong>Shadows are pitch black:</strong></p>
                        <ul>
                            <li>Ensure SkyLight is present and capturing</li>
                            <li>If using baked lighting, rebuild lighting</li>
                            <li>Enable Lumen for dynamic indirect lighting</li>
                        </ul>
                        
                        <p><strong>No atmospheric haze/depth:</strong></p>
                        <ul>
                            <li>Increase Exponential Height Fog density</li>
                            <li>Check Start Distance isn't set too high</li>
                            <li>Enable Volumetric Fog for more visible effect</li>
                        </ul>
                        
                        <p><strong>SkyLight not updating with sun rotation:</strong></p>
                        <ul>
                            <li>Set SkyLight Mobility to Movable</li>
                            <li>Enable "Real Time Capture"</li>
                            <li>Or manually click "Recapture Sky" after each change</li>
                        </ul>
                    </div>
                </details>

                <h3>Bonus Challenge: Sunset Scene</h3>

                <p>Duplicate your level and modify it to create a sunset scene:</p>
                <ol>
                    <li>Rotate Directional Light to Pitch = -5¬∞ to -10¬∞ (sun near horizon)</li>
                    <li>Change sun Temperature to 3000K-3500K (warmer orange)</li>
                    <li>Increase Mie Scattering Scale slightly for more haze</li>
                    <li>Update Fog Inscattering Color to warm orange</li>
                    <li>Observe how Sky Atmosphere automatically creates sunset colors</li>
                </ol>

                <p>The same four components create dramatically different moods just by adjusting sun position and color!</p>
            </section>

            <!-- Section 7: Summary -->
            <section id="summary" class="lesson-section">
                <h2>Summary</h2>

                <p>You've now mastered the fundamentals of outdoor lighting in Unreal Engine 5. Let's recap the essential components and concepts:</p>

                <div class="card" style="background: #f5f5f5; border-left: 4px solid #667eea;">
                    <h4>üéØ Key Takeaways</h4>
                    
                    <p><strong>Directional Light</strong> is your sun or moon‚Äîan infinitely distant light source with parallel rays. Key settings include rotation (sun position), color/temperature, source angle (shadow softness), and "Atmosphere Sun Light" to link with Sky Atmosphere.</p>

                    <p><strong>Sky Atmosphere</strong> simulates planetary atmospheric scattering, creating realistic blue skies and colorful sunsets. It automatically responds to your Directional Light's rotation. Rayleigh scattering creates blue sky; Mie scattering creates sun halos and haze.</p>

                    <p><strong>Exponential Height Fog</strong> adds depth and distance to your scenes. Fog density increases exponentially at lower altitudes. Enable Volumetric Fog for god rays and light interaction. Match fog color to your sky for natural blending.</p>

                    <p><strong>SkyLight</strong> provides ambient illumination by capturing light from the sky dome. Use Real Time Capture for dynamic skies. The Lower Hemisphere Color simulates ground bounce. Distance Field Ambient Occlusion adds subtle shadowing in crevices.</p>

                    <p><strong>Time-of-Day systems</strong> coordinate all four components through a controller. Movable lights + Lumen enable fully dynamic transitions. Use curves for artist-friendly control over colors and intensities throughout the day.</p>
                </div>

                <h3>Outdoor Lighting Quick Reference</h3>

                <!-- SVG: Component Summary -->
                <svg width="100%" height="240" viewBox="0 0 850 240" style="max-width: 850px; margin: 2rem auto; display: block; border: 2px solid #667eea; border-radius: 8px; background: #fff;">
                    <text x="425" y="25" text-anchor="middle" fill="#333" font-size="14" font-weight="bold">Outdoor Lighting Components Summary</text>
                    
                    <!-- Directional Light -->
                    <g transform="translate(30, 45)">
                        <rect x="0" y="0" width="180" height="170" rx="8" fill="#fff3e0" stroke="#f1c40f" stroke-width="2"/>
                        <text x="90" y="25" text-anchor="middle" fill="#f39c12" font-size="12" font-weight="bold">‚òÄÔ∏è Directional Light</text>
                        <line x1="10" y1="35" x2="170" y2="35" stroke="#f1c40f" opacity="0.5"/>
                        
                        <text x="15" y="55" fill="#333" font-size="9" font-weight="bold">Purpose:</text>
                        <text x="15" y="70" fill="#555" font-size="9">Sun/moon direct lighting</text>
                        
                        <text x="15" y="90" fill="#333" font-size="9" font-weight="bold">Key Settings:</text>
                        <text x="15" y="105" fill="#555" font-size="8">‚Ä¢ Rotation (sun position)</text>
                        <text x="15" y="118" fill="#555" font-size="8">‚Ä¢ Temperature/Color</text>
                        <text x="15" y="131" fill="#555" font-size="8">‚Ä¢ Atmosphere Sun Light ‚úì</text>
                        <text x="15" y="144" fill="#555" font-size="8">‚Ä¢ Source Angle (shadows)</text>
                        
                        <text x="15" y="162" fill="#4CAF50" font-size="8">Mobility: Movable for ToD</text>
                    </g>
                    
                    <!-- Sky Atmosphere -->
                    <g transform="translate(230, 45)">
                        <rect x="0" y="0" width="180" height="170" rx="8" fill="#e3f2fd" stroke="#2196F3" stroke-width="2"/>
                        <text x="90" y="25" text-anchor="middle" fill="#1976d2" font-size="12" font-weight="bold">üå§Ô∏è Sky Atmosphere</text>
                        <line x1="10" y1="35" x2="170" y2="35" stroke="#2196F3" opacity="0.5"/>
                        
                        <text x="15" y="55" fill="#333" font-size="9" font-weight="bold">Purpose:</text>
                        <text x="15" y="70" fill="#555" font-size="9">Realistic sky rendering</text>
                        
                        <text x="15" y="90" fill="#333" font-size="9" font-weight="bold">Key Settings:</text>
                        <text x="15" y="105" fill="#555" font-size="8">‚Ä¢ Rayleigh (blue sky)</text>
                        <text x="15" y="118" fill="#555" font-size="8">‚Ä¢ Mie (sun halo/haze)</text>
                        <text x="15" y="131" fill="#555" font-size="8">‚Ä¢ Atmosphere Height</text>
                        <text x="15" y="144" fill="#555" font-size="8">‚Ä¢ Linked to Dir Light</text>
                        
                        <text x="15" y="162" fill="#888" font-size="8">Auto-updates with sun</text>
                    </g>
                    
                    <!-- Height Fog -->
                    <g transform="translate(430, 45)">
                        <rect x="0" y="0" width="180" height="170" rx="8" fill="#f3e5f5" stroke="#9C27B0" stroke-width="2"/>
                        <text x="90" y="25" text-anchor="middle" fill="#7b1fa2" font-size="12" font-weight="bold">üå´Ô∏è Height Fog</text>
                        <line x1="10" y1="35" x2="170" y2="35" stroke="#9C27B0" opacity="0.5"/>
                        
                        <text x="15" y="55" fill="#333" font-size="9" font-weight="bold">Purpose:</text>
                        <text x="15" y="70" fill="#555" font-size="9">Atmospheric depth/haze</text>
                        
                        <text x="15" y="90" fill="#333" font-size="9" font-weight="bold">Key Settings:</text>
                        <text x="15" y="105" fill="#555" font-size="8">‚Ä¢ Fog Density</text>
                        <text x="15" y="118" fill="#555" font-size="8">‚Ä¢ Height Falloff</text>
                        <text x="15" y="131" fill="#555" font-size="8">‚Ä¢ Inscattering Color</text>
                        <text x="15" y="144" fill="#555" font-size="8">‚Ä¢ Volumetric Fog ‚úì</text>
                        
                        <text x="15" y="162" fill="#888" font-size="8">Enables god rays</text>
                    </g>
                    
                    <!-- SkyLight -->
                    <g transform="translate(630, 45)">
                        <rect x="0" y="0" width="180" height="170" rx="8" fill="#e8f5e9" stroke="#4CAF50" stroke-width="2"/>
                        <text x="90" y="25" text-anchor="middle" fill="#2e7d32" font-size="12" font-weight="bold">üí° SkyLight</text>
                        <line x1="10" y1="35" x2="170" y2="35" stroke="#4CAF50" opacity="0.5"/>
                        
                        <text x="15" y="55" fill="#333" font-size="9" font-weight="bold">Purpose:</text>
                        <text x="15" y="70" fill="#555" font-size="9">Ambient fill from sky</text>
                        
                        <text x="15" y="90" fill="#333" font-size="9" font-weight="bold">Key Settings:</text>
                        <text x="15" y="105" fill="#555" font-size="8">‚Ä¢ Captured Scene mode</text>
                        <text x="15" y="118" fill="#555" font-size="8">‚Ä¢ Real Time Capture</text>
                        <text x="15" y="131" fill="#555" font-size="8">‚Ä¢ Lower Hemisphere Color</text>
                        <text x="15" y="144" fill="#555" font-size="8">‚Ä¢ DFAO settings</text>
                        
                        <text x="15" y="162" fill="#4CAF50" font-size="8">Mobility: Movable for ToD</text>
                    </g>
                </svg>

                <h3>The Complete Outdoor Setup Workflow</h3>

                <!-- Mermaid: Setup Workflow -->
                <pre class="mermaid">
flowchart LR
    A["1. Create Level<br/>Add ground/objects"] --> B["2. Directional Light<br/>Set rotation + color"]
    B --> C["3. Sky Atmosphere<br/>Link to sun"]
    C --> D["4. Height Fog<br/>Add depth"]
    D --> E["5. SkyLight<br/>Ambient fill"]
    E --> F["6. Fine-tune<br/>Balance & test"]
    
    style A fill:#667eea,color:#fff
    style B fill:#f1c40f,color:#333
    style C fill:#2196F3,color:#fff
    style D fill:#9C27B0,color:#fff
    style E fill:#4CAF50,color:#fff
    style F fill:#e91e63,color:#fff
                </pre>
                <p class="caption"><em>Figure: The standard workflow for setting up outdoor lighting.</em></p>

                <h3>What's Next?</h3>

                <p>With outdoor lighting mastered, the next lesson focuses on <strong>Interior Lighting</strong>‚Äîa completely different challenge. You'll learn to use Point Lights, Spot Lights, and Rect Lights to illuminate indoor spaces, work with IES profiles for realistic light falloff patterns, and create mood through strategic light placement.</p>

                <p>The skills you've learned here‚Äîunderstanding how light components work together, balancing direct and ambient light, and using atmospheric effects‚Äîwill directly transfer to interior work. You'll just be applying them in enclosed spaces with more localized light sources.</p>
            </section>

            <!-- Lesson Navigation -->
            <nav class="lesson-nav" aria-label="Lesson navigation">
                <a href="m04_l01_lighting_fundamentals.html" class="btn">‚Üê Previous: Lighting Fundamentals</a>
                <a href="index.html" class="btn btn-outline">Course Home</a>
                <a href="m04_l03_interior_lighting.html" class="btn">Next: Interior Lighting ‚Üí</a>
            </nav>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <p>&copy; 2025 Introduction to Unreal Engine 5 Course. Part of the Practical Ace learning series.</p>
            <nav aria-label="Footer navigation">
                <a href="index.html">Home</a>
                <a href="index.html#modules">All Modules</a>
            </nav>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // Progress indicator
        window.addEventListener('scroll', () => {
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrolled = (window.scrollY / docHeight) * 100;
            document.querySelector('.progress-bar').style.width = scrolled + '%';
        });

        // Mobile menu toggle
        const menuToggle = document.getElementById('mobile-menu-toggle');
        const navLinks = document.getElementById('nav-links');
        
        menuToggle?.addEventListener('click', () => {
            const expanded = menuToggle.getAttribute('aria-expanded') === 'true';
            menuToggle.setAttribute('aria-expanded', !expanded);
            navLinks.classList.toggle('active');
        });

        // Theme toggle
        const themeToggle = document.getElementById('theme-toggle');
        const savedTheme = localStorage.getItem('theme');
        
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
            themeToggle.textContent = '‚òÄÔ∏è';
        }

        themeToggle?.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            themeToggle.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
        });

        // Smooth scrolling for TOC links
        document.querySelectorAll('.toc-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href').slice(1);
                const target = document.getElementById(targetId);
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    history.pushState(null, null, `#${targetId}`);
                }
            });
        });
    </script>
</body>
</html>
